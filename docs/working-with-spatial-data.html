<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 9 Working with Spatial Data | WFC 70: Data Literacy for Wildlife Biologists</title>
  <meta name="description" content=" 9 Working with Spatial Data | WFC 70: Data Literacy for Wildlife Biologists" />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content=" 9 Working with Spatial Data | WFC 70: Data Literacy for Wildlife Biologists" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 9 Working with Spatial Data | WFC 70: Data Literacy for Wildlife Biologists" />
  
  
  

<meta name="author" content="Rob Furrow" />


<meta name="date" content="2025-11-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modeling-conditionals-loops-functions.html"/>
<link rel="next" href="lab-1-r-data-and-the-rstudio-panels-2025.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">WFC70</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to WFC 70</a></li>
<li class="chapter" data-level="" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="0.1" data-path="getting-started.html"><a href="getting-started.html#installing-r-and-r-studio"><i class="fa fa-check"></i><b>0.1</b> Installing R and R Studio</a></li>
<li class="chapter" data-level="0.2" data-path="getting-started.html"><a href="getting-started.html#tips-for-getting-started-with-labs"><i class="fa fa-check"></i><b>0.2</b> Tips for Getting Started With Labs</a></li>
<li class="chapter" data-level="0.3" data-path="getting-started.html"><a href="getting-started.html#tips-for-working-from-home"><i class="fa fa-check"></i><b>0.3</b> Tips for Working From Home</a></li>
<li class="chapter" data-level="0.4" data-path="getting-started.html"><a href="getting-started.html#shortcuts"><i class="fa fa-check"></i><b>0.4</b> Shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro-to-r-and-r-studio.html"><a href="intro-to-r-and-r-studio.html"><i class="fa fa-check"></i><b>1</b> Intro to R and R Studio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-to-r-and-r-studio.html"><a href="intro-to-r-and-r-studio.html#packages"><i class="fa fa-check"></i><b>1.1</b> Packages</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="intro-to-r-and-r-studio.html"><a href="intro-to-r-and-r-studio.html#installing-packages"><i class="fa fa-check"></i><b>1.1.1</b> Installing Packages</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro-to-r-and-r-studio.html"><a href="intro-to-r-and-r-studio.html#finding-packages"><i class="fa fa-check"></i><b>1.1.2</b> Finding Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro-to-r-and-r-studio.html"><a href="intro-to-r-and-r-studio.html#knitting"><i class="fa fa-check"></i><b>1.2</b> Knitting</a></li>
<li class="chapter" data-level="1.3" data-path="intro-to-r-and-r-studio.html"><a href="intro-to-r-and-r-studio.html#knitting-1"><i class="fa fa-check"></i><b>1.3</b> Knitting</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="code-not-working.html"><a href="code-not-working.html"><i class="fa fa-check"></i><b>2</b> Code not Working?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="code-not-working.html"><a href="code-not-working.html#checklist"><i class="fa fa-check"></i><b>2.1</b> Checklist</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="code-not-working.html"><a href="code-not-working.html#example-fix-the-code"><i class="fa fa-check"></i><b>2.1.1</b> Example: Fix the Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>3</b> Importing Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="importing-data.html"><a href="importing-data.html#finding-data"><i class="fa fa-check"></i><b>3.1</b> Finding Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="omitting-code.html"><a href="omitting-code.html"><i class="fa fa-check"></i><b>4</b> Omitting code</a>
<ul>
<li class="chapter" data-level="4.1" data-path="omitting-code.html"><a href="omitting-code.html#default-fields"><i class="fa fa-check"></i><b>4.1</b> Default fields</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>5</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-visualization.html"><a href="data-visualization.html#types-of-graphs"><i class="fa fa-check"></i><b>5.1</b> Types of Graphs</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-visualization.html"><a href="data-visualization.html#histogram"><i class="fa fa-check"></i><b>5.1.1</b> Histogram</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-visualization.html"><a href="data-visualization.html#violin-plot"><i class="fa fa-check"></i><b>5.1.2</b> Violin Plot</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-visualization.html"><a href="data-visualization.html#box-plot"><i class="fa fa-check"></i><b>5.1.3</b> Box Plot</a></li>
<li class="chapter" data-level="5.1.4" data-path="data-visualization.html"><a href="data-visualization.html#scatter-plot"><i class="fa fa-check"></i><b>5.1.4</b> Scatter Plot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-visualization.html"><a href="data-visualization.html#extra-resources"><i class="fa fa-check"></i><b>5.2</b> Extra Resources</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>6</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-wrangling.html"><a href="data-wrangling.html#review"><i class="fa fa-check"></i><b>6.1</b> Review</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#filter"><i class="fa fa-check"></i><b>6.1.1</b> Filter</a></li>
<li class="chapter" data-level="6.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#joins"><i class="fa fa-check"></i><b>6.1.2</b> Joins</a></li>
<li class="chapter" data-level="6.1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#select"><i class="fa fa-check"></i><b>6.1.3</b> Select</a></li>
<li class="chapter" data-level="6.1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#mutate"><i class="fa fa-check"></i><b>6.1.4</b> Mutate</a></li>
<li class="chapter" data-level="6.1.5" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot"><i class="fa fa-check"></i><b>6.1.5</b> Pivot</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-wrangling.html"><a href="data-wrangling.html#tying-everything-together"><i class="fa fa-check"></i><b>6.2</b> Tying Everything Together</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#checklist-1"><i class="fa fa-check"></i><b>6.2.1</b> Checklist</a></li>
<li class="chapter" data-level="6.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#example"><i class="fa fa-check"></i><b>6.2.2</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mark-recapture.html"><a href="mark-recapture.html"><i class="fa fa-check"></i><b>7</b> Mark-Recapture</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mark-recapture.html"><a href="mark-recapture.html#example-1"><i class="fa fa-check"></i><b>7.1</b> Example</a></li>
<li class="chapter" data-level="7.2" data-path="mark-recapture.html"><a href="mark-recapture.html#practice-1-estimating-population-size"><i class="fa fa-check"></i><b>7.2</b> Practice 1: Estimating population size</a></li>
<li class="chapter" data-level="7.3" data-path="mark-recapture.html"><a href="mark-recapture.html#mark-recaptured-in-r"><i class="fa fa-check"></i><b>7.3</b> Mark-Recaptured in R</a></li>
<li class="chapter" data-level="7.4" data-path="mark-recapture.html"><a href="mark-recapture.html#practice-2"><i class="fa fa-check"></i><b>7.4</b> Practice 2</a></li>
<li class="chapter" data-level="7.5" data-path="mark-recapture.html"><a href="mark-recapture.html#practice-3"><i class="fa fa-check"></i><b>7.5</b> Practice 3</a></li>
<li class="chapter" data-level="7.6" data-path="mark-recapture.html"><a href="mark-recapture.html#answers"><i class="fa fa-check"></i><b>7.6</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling-conditionals-loops-functions.html"><a href="modeling-conditionals-loops-functions.html"><i class="fa fa-check"></i><b>8</b> Modeling (conditionals, loops, functions)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modeling-conditionals-loops-functions.html"><a href="modeling-conditionals-loops-functions.html#motivation-why-learn-loops-and-conditional-statements"><i class="fa fa-check"></i><b>8.1</b> Motivation: why learn loops and conditional statements?</a></li>
<li class="chapter" data-level="8.2" data-path="modeling-conditionals-loops-functions.html"><a href="modeling-conditionals-loops-functions.html#loops-in-r-for-statements"><i class="fa fa-check"></i><b>8.2</b> Loops in <code>R</code> (<code>for</code> statements)</a></li>
<li class="chapter" data-level="8.3" data-path="modeling-conditionals-loops-functions.html"><a href="modeling-conditionals-loops-functions.html#conditional-statements-in-r-if-else"><i class="fa fa-check"></i><b>8.3</b> Conditional Statements in <code>R</code> (<code>if</code>, <code>else</code>)</a></li>
<li class="chapter" data-level="8.4" data-path="modeling-conditionals-loops-functions.html"><a href="modeling-conditionals-loops-functions.html#connection-to-data-visualization"><i class="fa fa-check"></i><b>8.4</b> Connection to Data Visualization</a></li>
<li class="chapter" data-level="8.5" data-path="modeling-conditionals-loops-functions.html"><a href="modeling-conditionals-loops-functions.html#functions-in-r"><i class="fa fa-check"></i><b>8.5</b> Functions in <code>R</code></a></li>
<li class="chapter" data-level="8.6" data-path="modeling-conditionals-loops-functions.html"><a href="modeling-conditionals-loops-functions.html#conclusion"><i class="fa fa-check"></i><b>8.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="working-with-spatial-data.html"><a href="working-with-spatial-data.html"><i class="fa fa-check"></i><b>9</b> Working with Spatial Data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="working-with-spatial-data.html"><a href="working-with-spatial-data.html#understanding-coordinate-reference-systemscrs"><i class="fa fa-check"></i><b>9.1</b> Understanding coordinate reference systems(CRS)</a></li>
</ul></li>
<li class="appendix"><span><b>WFC 70 Labs</b></span></li>
<li class="chapter" data-level="A" data-path="lab-1-r-data-and-the-rstudio-panels-2025.html"><a href="lab-1-r-data-and-the-rstudio-panels-2025.html"><i class="fa fa-check"></i><b>A</b> Lab 1: R, data, and the RStudio panels (2025)</a>
<ul>
<li class="chapter" data-level="A.1" data-path="lab-1-r-data-and-the-rstudio-panels-2025.html"><a href="lab-1-r-data-and-the-rstudio-panels-2025.html#part-1-orienting-ourselves-to-rstudio-10-minutes-instructor-will-lead"><i class="fa fa-check"></i><b>A.1</b> Part 1: Orienting ourselves to RStudio (10 minutes, instructor will lead)</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="lab-1-r-data-and-the-rstudio-panels-2025.html"><a href="lab-1-r-data-and-the-rstudio-panels-2025.html#the-command-line-console-versus-a-r-script"><i class="fa fa-check"></i><b>A.1.1</b> The command line / “Console” versus a R script</a></li>
<li class="chapter" data-level="A.1.2" data-path="lab-1-r-data-and-the-rstudio-panels-2025.html"><a href="lab-1-r-data-and-the-rstudio-panels-2025.html#r-data-is-often-stored-in-vectors"><i class="fa fa-check"></i><b>A.1.2</b> R data is often stored in “vectors”</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="lab-1-r-data-and-the-rstudio-panels-2025.html"><a href="lab-1-r-data-and-the-rstudio-panels-2025.html#part-2-trying-things-out-yourselves-10-minutes-on-your-own"><i class="fa fa-check"></i><b>A.2</b> Part 2: Trying things out yourselves (10 minutes, on your own)</a></li>
<li class="chapter" data-level="A.3" data-path="lab-1-r-data-and-the-rstudio-panels-2025.html"><a href="lab-1-r-data-and-the-rstudio-panels-2025.html#part-3-making-toast-10-minutes-total"><i class="fa fa-check"></i><b>A.3</b> Part 3: Making toast (10 minutes total)</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="lab-1-r-data-and-the-rstudio-panels-2025.html"><a href="lab-1-r-data-and-the-rstudio-panels-2025.html#class-discussion-5-minutes-instructor-will-lead"><i class="fa fa-check"></i><b>A.3.1</b> Class discussion (5 minutes, instructor will lead)</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="lab-1-r-data-and-the-rstudio-panels-2025.html"><a href="lab-1-r-data-and-the-rstudio-panels-2025.html#part-4-data-frames-to-link-data-together-5-minutes-instructor-will-lead"><i class="fa fa-check"></i><b>A.4</b> Part 4: Data frames to link data together (5 minutes, instructor will lead)</a></li>
<li class="chapter" data-level="A.5" data-path="lab-1-r-data-and-the-rstudio-panels-2025.html"><a href="lab-1-r-data-and-the-rstudio-panels-2025.html#wrapping-up-5-minutes"><i class="fa fa-check"></i><b>A.5</b> Wrapping up (5 minutes)</a></li>
<li class="chapter" data-level="A.6" data-path="lab-1-r-data-and-the-rstudio-panels-2025.html"><a href="lab-1-r-data-and-the-rstudio-panels-2025.html#extra-material-for-interest-will-not-be-assessed-on-any-homework"><i class="fa fa-check"></i><b>A.6</b> Extra material for interest (will not be assessed on any homework)</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="lab-2-indices-in-r-r-markdown-2025.html"><a href="lab-2-indices-in-r-r-markdown-2025.html"><i class="fa fa-check"></i><b>B</b> Lab 2: Indices in R, R Markdown (2025)</a>
<ul>
<li class="chapter" data-level="B.1" data-path="lab-2-indices-in-r-r-markdown-2025.html"><a href="lab-2-indices-in-r-r-markdown-2025.html#part-1-r-vs.-rstudio-.r-vs.-.rmd-files-5-minutes-instructor-leading"><i class="fa fa-check"></i><b>B.1</b> Part 1: R vs. RStudio, .R vs. .Rmd files (5 minutes, instructor leading)</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="lab-2-indices-in-r-r-markdown-2025.html"><a href="lab-2-indices-in-r-r-markdown-2025.html#r-vs.-rstudio"><i class="fa fa-check"></i><b>B.1.1</b> R vs. RStudio</a></li>
<li class="chapter" data-level="B.1.2" data-path="lab-2-indices-in-r-r-markdown-2025.html"><a href="lab-2-indices-in-r-r-markdown-2025.html#r-scripts-.r-files-vs.-r-markdown-files-.rmd"><i class="fa fa-check"></i><b>B.1.2</b> R scripts (.R files) vs. R Markdown files (.Rmd)</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="lab-2-indices-in-r-r-markdown-2025.html"><a href="lab-2-indices-in-r-r-markdown-2025.html#part-2-indices-and-column-names-5-minutes-instructor-will-lead"><i class="fa fa-check"></i><b>B.2</b> Part 2: Indices and column names (5 minutes, instructor will lead)</a></li>
<li class="chapter" data-level="B.3" data-path="lab-2-indices-in-r-r-markdown-2025.html"><a href="lab-2-indices-in-r-r-markdown-2025.html#part-3-index-work-on-your-own-10-minutes-on-your-own"><i class="fa fa-check"></i><b>B.3</b> Part 3: Index work on your own (10 minutes, on your own)</a></li>
<li class="chapter" data-level="B.4" data-path="lab-2-indices-in-r-r-markdown-2025.html"><a href="lab-2-indices-in-r-r-markdown-2025.html#part-4-messing-around-with-r-markdown-15-minutes-on-your-own"><i class="fa fa-check"></i><b>B.4</b> Part 4: Messing around with R Markdown (15 minutes, on your own)</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="lab-2-indices-in-r-r-markdown-2025.html"><a href="lab-2-indices-in-r-r-markdown-2025.html#here-i-am-writing-a-regular-sentence-it-should-not-be-big-and-weird"><i class="fa fa-check"></i><b>B.4.1</b> Here I am writing a regular sentence, it should not be big and weird!</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="lab-2-indices-in-r-r-markdown-2025.html"><a href="lab-2-indices-in-r-r-markdown-2025.html#wrapping-up-5-minutes-1"><i class="fa fa-check"></i><b>B.5</b> Wrapping up (5 minutes)</a></li>
<li class="chapter" data-level="B.6" data-path="lab-2-indices-in-r-r-markdown-2025.html"><a href="lab-2-indices-in-r-r-markdown-2025.html#extra-material-for-interest"><i class="fa fa-check"></i><b>B.6</b> Extra material for interest</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="lab-3-visualizing-data-in-r-part-1-2025.html"><a href="lab-3-visualizing-data-in-r-part-1-2025.html"><i class="fa fa-check"></i><b>C</b> Lab 3: Visualizing data in R (Part 1) (2025)</a>
<ul>
<li class="chapter" data-level="C.0.1" data-path="lab-3-visualizing-data-in-r-part-1-2025.html"><a href="lab-3-visualizing-data-in-r-part-1-2025.html#resources"><i class="fa fa-check"></i><b>C.0.1</b> Resources</a></li>
<li class="chapter" data-level="C.1" data-path="lab-3-visualizing-data-in-r-part-1-2025.html"><a href="lab-3-visualizing-data-in-r-part-1-2025.html#part-1-packages-in-r-covered-in-lecture-so-only-here-for-reference"><i class="fa fa-check"></i><b>C.1</b> Part 1: Packages in R (covered in lecture, so only here for reference)</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="lab-3-visualizing-data-in-r-part-1-2025.html"><a href="lab-3-visualizing-data-in-r-part-1-2025.html#installing-an-r-package"><i class="fa fa-check"></i><b>C.1.1</b> Installing an R package</a></li>
<li class="chapter" data-level="C.1.2" data-path="lab-3-visualizing-data-in-r-part-1-2025.html"><a href="lab-3-visualizing-data-in-r-part-1-2025.html#loading-an-r-package"><i class="fa fa-check"></i><b>C.1.2</b> Loading an R package</a></li>
<li class="chapter" data-level="C.1.3" data-path="lab-3-visualizing-data-in-r-part-1-2025.html"><a href="lab-3-visualizing-data-in-r-part-1-2025.html#part-1b-5-minutes-instructor-leading"><i class="fa fa-check"></i><b>C.1.3</b> Part 1b (5 minutes, instructor leading)</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="lab-3-visualizing-data-in-r-part-1-2025.html"><a href="lab-3-visualizing-data-in-r-part-1-2025.html#part-2-using-ggplot-for-plotting-in-r-15-minutes-self-led"><i class="fa fa-check"></i><b>C.2</b> Part 2: Using ggplot() for plotting in R (15 minutes, self-led)</a></li>
<li class="chapter" data-level="C.3" data-path="lab-3-visualizing-data-in-r-part-1-2025.html"><a href="lab-3-visualizing-data-in-r-part-1-2025.html#part-3-exploring-15-minutes-self-led"><i class="fa fa-check"></i><b>C.3</b> Part 3: Exploring (15 minutes, self-led)</a></li>
<li class="chapter" data-level="C.4" data-path="lab-3-visualizing-data-in-r-part-1-2025.html"><a href="lab-3-visualizing-data-in-r-part-1-2025.html#wrapping-up-5-minutes-2"><i class="fa fa-check"></i><b>C.4</b> Wrapping up (5 minutes)</a></li>
<li class="chapter" data-level="C.5" data-path="lab-3-visualizing-data-in-r-part-1-2025.html"><a href="lab-3-visualizing-data-in-r-part-1-2025.html#extra-material"><i class="fa fa-check"></i><b>C.5</b> Extra material</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html"><i class="fa fa-check"></i><b>D</b> Lab 4: visualizing data in R (part 2) (2025)</a>
<ul>
<li class="chapter" data-level="D.1" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#goals"><i class="fa fa-check"></i><b>D.1</b> Goals</a>
<ul>
<li class="chapter" data-level="D.1.1" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#resources-1"><i class="fa fa-check"></i><b>D.1.1</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#part-0-figure-of-the-week-5-10-minutes-instructor-leading"><i class="fa fa-check"></i><b>D.2</b> Part 0: Figure of the week (5-10 minutes, instructor leading)</a></li>
<li class="chapter" data-level="D.3" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#part-1-new-data-5-minutes-instructor-leading"><i class="fa fa-check"></i><b>D.3</b> Part 1: New data! (5 minutes, instructor leading)</a>
<ul>
<li class="chapter" data-level="D.3.1" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#loading-data"><i class="fa fa-check"></i><b>D.3.1</b> Loading data</a></li>
<li class="chapter" data-level="D.3.2" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#about-these-data-for-reference-not-for-discussion-during-lab"><i class="fa fa-check"></i><b>D.3.2</b> About these data (for reference, not for discussion during lab)</a></li>
</ul></li>
<li class="chapter" data-level="D.4" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#independent-work-25-minutes"><i class="fa fa-check"></i><b>D.4</b> Independent work (25 minutes)</a>
<ul>
<li class="chapter" data-level="D.4.1" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#task-1-working-with-geom_jitter"><i class="fa fa-check"></i><b>D.4.1</b> Task 1: working with <code>geom_jitter()</code></a></li>
<li class="chapter" data-level="D.4.2" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#making-consistent-changes-to-data-attributes"><i class="fa fa-check"></i><b>D.4.2</b> Making consistent changes to data attributes</a></li>
<li class="chapter" data-level="D.4.3" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#task-2-changing-attributes-throughout-a-plot"><i class="fa fa-check"></i><b>D.4.3</b> Task 2: changing attributes throughout a plot</a></li>
<li class="chapter" data-level="D.4.4" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#adding-a-theme"><i class="fa fa-check"></i><b>D.4.4</b> Adding a theme</a></li>
<li class="chapter" data-level="D.4.5" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#task-3-themes"><i class="fa fa-check"></i><b>D.4.5</b> Task 3: themes</a></li>
<li class="chapter" data-level="D.4.6" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#customizing-labels"><i class="fa fa-check"></i><b>D.4.6</b> Customizing labels</a></li>
<li class="chapter" data-level="D.4.7" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#interlude-finding-data-for-the-data-story-assignment"><i class="fa fa-check"></i><b>D.4.7</b> Interlude: finding data for the Data Story assignment</a></li>
<li class="chapter" data-level="D.4.8" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#task-4-nice-labels-time-permitting"><i class="fa fa-check"></i><b>D.4.8</b> Task 4: Nice labels (time permitting)</a></li>
</ul></li>
<li class="chapter" data-level="D.5" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#wrapping-up-5-minutes-3"><i class="fa fa-check"></i><b>D.5</b> Wrapping up (5 minutes)</a></li>
<li class="chapter" data-level="D.6" data-path="lab-4-visualizing-data-in-r-part-2-2025.html"><a href="lab-4-visualizing-data-in-r-part-2-2025.html#extra-material-for-interest-will-not-be-assessed-on-any-homework-1"><i class="fa fa-check"></i><b>D.6</b> Extra material for interest (will not be assessed on any homework)</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html"><i class="fa fa-check"></i><b>E</b> Lab 5: data story work, wrangling warm-up (2025)</a>
<ul>
<li class="chapter" data-level="E.1" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html#goals-1"><i class="fa fa-check"></i><b>E.1</b> Goals</a>
<ul>
<li class="chapter" data-level="E.1.1" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html#resources-2"><i class="fa fa-check"></i><b>E.1.1</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="E.2" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html#part-0-figure-of-the-week-5-minutes-instructor-leading"><i class="fa fa-check"></i><b>E.2</b> Part 0: Figure of the week (5 minutes, instructor leading)</a></li>
<li class="chapter" data-level="E.3" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html#part-1-new-data-5-minutes-instructor-leading-1"><i class="fa fa-check"></i><b>E.3</b> Part 1: New data! (5 minutes, instructor leading)</a>
<ul>
<li class="chapter" data-level="E.3.1" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html#loading-data-1"><i class="fa fa-check"></i><b>E.3.1</b> Loading data</a></li>
<li class="chapter" data-level="E.3.2" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html#about-these-data"><i class="fa fa-check"></i><b>E.3.2</b> About these data</a></li>
</ul></li>
<li class="chapter" data-level="E.4" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html#part-1-visualizing-size-relationships"><i class="fa fa-check"></i><b>E.4</b> Part 1: visualizing size relationships</a>
<ul>
<li class="chapter" data-level="E.4.1" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html#your-task-10-minutes"><i class="fa fa-check"></i><b>E.4.1</b> Your task (10 minutes)</a></li>
</ul></li>
<li class="chapter" data-level="E.5" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html#part-2-a-wrangling-plan"><i class="fa fa-check"></i><b>E.5</b> Part 2: a wrangling plan</a></li>
<li class="chapter" data-level="E.6" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html#wrapping-up-5-minutes-4"><i class="fa fa-check"></i><b>E.6</b> Wrapping up (5 minutes)</a></li>
<li class="chapter" data-level="E.7" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html#extra-material-1"><i class="fa fa-check"></i><b>E.7</b> Extra material</a>
<ul>
<li class="chapter" data-level="E.7.1" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html#transforming-the-data-scary-code-behind-the-scenes"><i class="fa fa-check"></i><b>E.7.1</b> Transforming the data (scary code behind the scenes)</a></li>
<li class="chapter" data-level="E.7.2" data-path="lab-5-data-story-work-wrangling-warm-up-2025.html"><a href="lab-5-data-story-work-wrangling-warm-up-2025.html#your-task"><i class="fa fa-check"></i><b>E.7.2</b> Your task</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="F" data-path="lab-6-mark-recapture-2025.html"><a href="lab-6-mark-recapture-2025.html"><i class="fa fa-check"></i><b>F</b> Lab 6: mark-recapture (2025)</a>
<ul>
<li class="chapter" data-level="F.1" data-path="lab-6-mark-recapture-2025.html"><a href="lab-6-mark-recapture-2025.html#goals-2"><i class="fa fa-check"></i><b>F.1</b> Goals</a>
<ul>
<li class="chapter" data-level="F.1.1" data-path="lab-6-mark-recapture-2025.html"><a href="lab-6-mark-recapture-2025.html#resources-3"><i class="fa fa-check"></i><b>F.1.1</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="F.2" data-path="lab-6-mark-recapture-2025.html"><a href="lab-6-mark-recapture-2025.html#part-0-figure-of-the-week-5-minutes-instructor-leading-1"><i class="fa fa-check"></i><b>F.2</b> Part 0: Figure of the week (5 minutes, instructor leading)</a></li>
<li class="chapter" data-level="F.3" data-path="lab-6-mark-recapture-2025.html"><a href="lab-6-mark-recapture-2025.html#part-1-reminder-of-lecture-data-10-minutes-instructor-leading"><i class="fa fa-check"></i><b>F.3</b> Part 1: Reminder of lecture data (10 minutes, instructor leading)</a></li>
<li class="chapter" data-level="F.4" data-path="lab-6-mark-recapture-2025.html"><a href="lab-6-mark-recapture-2025.html#adding-weather-data-joining-data-frames"><i class="fa fa-check"></i><b>F.4</b> Adding weather data (joining data frames)</a></li>
<li class="chapter" data-level="F.5" data-path="lab-6-mark-recapture-2025.html"><a href="lab-6-mark-recapture-2025.html#western-harvest-mouse-population-size-on-your-own-15-minutes"><i class="fa fa-check"></i><b>F.5</b> Western harvest mouse population size (on your own, 15 minutes)</a>
<ul>
<li class="chapter" data-level="F.5.1" data-path="lab-6-mark-recapture-2025.html"><a href="lab-6-mark-recapture-2025.html#your-data"><i class="fa fa-check"></i><b>F.5.1</b> Your data</a></li>
<li class="chapter" data-level="F.5.2" data-path="lab-6-mark-recapture-2025.html"><a href="lab-6-mark-recapture-2025.html#getting-your-mark-recapture-table"><i class="fa fa-check"></i><b>F.5.2</b> Getting your mark-recapture table</a></li>
<li class="chapter" data-level="F.5.3" data-path="lab-6-mark-recapture-2025.html"><a href="lab-6-mark-recapture-2025.html#more-joining-time-permitting"><i class="fa fa-check"></i><b>F.5.3</b> More joining (time permitting)</a></li>
</ul></li>
<li class="chapter" data-level="F.6" data-path="lab-6-mark-recapture-2025.html"><a href="lab-6-mark-recapture-2025.html#wrapping-up-5-minutes-5"><i class="fa fa-check"></i><b>F.6</b> Wrapping up (5 minutes)</a></li>
<li class="chapter" data-level="F.7" data-path="lab-6-mark-recapture-2025.html"><a href="lab-6-mark-recapture-2025.html#extra-material-2"><i class="fa fa-check"></i><b>F.7</b> Extra material</a></li>
</ul></li>
<li class="chapter" data-level="G" data-path="lab-7-file-management-troubleshooting-data-story-2025.html"><a href="lab-7-file-management-troubleshooting-data-story-2025.html"><i class="fa fa-check"></i><b>G</b> Lab 7: file management, troubleshooting, data story (2025)</a>
<ul>
<li class="chapter" data-level="G.1" data-path="lab-7-file-management-troubleshooting-data-story-2025.html"><a href="lab-7-file-management-troubleshooting-data-story-2025.html#goals-3"><i class="fa fa-check"></i><b>G.1</b> Goals</a>
<ul>
<li class="chapter" data-level="G.1.1" data-path="lab-7-file-management-troubleshooting-data-story-2025.html"><a href="lab-7-file-management-troubleshooting-data-story-2025.html#resources-4"><i class="fa fa-check"></i><b>G.1.1</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="G.2" data-path="lab-7-file-management-troubleshooting-data-story-2025.html"><a href="lab-7-file-management-troubleshooting-data-story-2025.html#part-0-figure-of-the-week-5-minutes-instructor-leading-2"><i class="fa fa-check"></i><b>G.2</b> Part 0: Figure of the week (5 minutes, instructor leading)</a></li>
<li class="chapter" data-level="G.3" data-path="lab-7-file-management-troubleshooting-data-story-2025.html"><a href="lab-7-file-management-troubleshooting-data-story-2025.html#part-1-navigating-file-structure-10-minutes-on-your-own"><i class="fa fa-check"></i><b>G.3</b> Part 1: Navigating file structure (10 minutes, on your own)</a>
<ul>
<li class="chapter" data-level="G.3.1" data-path="lab-7-file-management-troubleshooting-data-story-2025.html"><a href="lab-7-file-management-troubleshooting-data-story-2025.html#unzipping-lab7_data.zip"><i class="fa fa-check"></i><b>G.3.1</b> Unzipping “Lab7_data.zip”</a></li>
<li class="chapter" data-level="G.3.2" data-path="lab-7-file-management-troubleshooting-data-story-2025.html"><a href="lab-7-file-management-troubleshooting-data-story-2025.html#loading-the-data"><i class="fa fa-check"></i><b>G.3.2</b> Loading the data</a></li>
</ul></li>
<li class="chapter" data-level="G.4" data-path="lab-7-file-management-troubleshooting-data-story-2025.html"><a href="lab-7-file-management-troubleshooting-data-story-2025.html#part-2-dealing-with-wonky-data-10-minutes-on-your-own"><i class="fa fa-check"></i><b>G.4</b> Part 2: Dealing with wonky data (10 minutes, on your own)</a></li>
<li class="chapter" data-level="G.5" data-path="lab-7-file-management-troubleshooting-data-story-2025.html"><a href="lab-7-file-management-troubleshooting-data-story-2025.html#data-story-work-any-remaining-time"><i class="fa fa-check"></i><b>G.5</b> Data story work (any remaining time)</a></li>
<li class="chapter" data-level="G.6" data-path="lab-7-file-management-troubleshooting-data-story-2025.html"><a href="lab-7-file-management-troubleshooting-data-story-2025.html#wrapping-up-5-minutes-6"><i class="fa fa-check"></i><b>G.6</b> Wrapping up (5 minutes)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">WFC 70: Data Literacy for Wildlife Biologists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="working-with-spatial-data" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number"> 9</span> Working with Spatial Data<a href="working-with-spatial-data.html#working-with-spatial-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Author: Mingyuan Li</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="working-with-spatial-data.html#cb35-1" tabindex="-1"></a><span class="co"># We are using multiple new packages, install and load them if you haven&#39;t done it so:</span></span>
<span id="cb35-2"><a href="working-with-spatial-data.html#cb35-2" tabindex="-1"></a><span class="co"># install.packages(c(&quot;move&quot;, &quot;move2&quot;, &quot;sf&quot;, &quot;raster&quot;, &quot;terra&quot;, &quot;sp&quot;, &quot;adehabitatHR&quot;, &quot;amt&quot;, &quot;mapview&quot;))</span></span>
<span id="cb35-3"><a href="working-with-spatial-data.html#cb35-3" tabindex="-1"></a><span class="fu">library</span>(move)</span>
<span id="cb35-4"><a href="working-with-spatial-data.html#cb35-4" tabindex="-1"></a><span class="fu">library</span>(move2)</span>
<span id="cb35-5"><a href="working-with-spatial-data.html#cb35-5" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb35-6"><a href="working-with-spatial-data.html#cb35-6" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb35-7"><a href="working-with-spatial-data.html#cb35-7" tabindex="-1"></a><span class="fu">library</span>(adehabitatHR)</span>
<span id="cb35-8"><a href="working-with-spatial-data.html#cb35-8" tabindex="-1"></a><span class="fu">library</span>(amt)</span>
<span id="cb35-9"><a href="working-with-spatial-data.html#cb35-9" tabindex="-1"></a><span class="fu">library</span>(mapview)</span>
<span id="cb35-10"><a href="working-with-spatial-data.html#cb35-10" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb35-11"><a href="working-with-spatial-data.html#cb35-11" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb35-12"><a href="working-with-spatial-data.html#cb35-12" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Before we start, let’s talk about GIS!
GIS stands for geographic information system, it help us analyze and visualize data that
are spatial in nature.</p>
<p>What is the different between spatial data and other data types? Ultimately, not much!
Just like other data types, spatial locations can be depicted on x and y axes.
But if we were to include things like elevation, then we can use 3-dimensional
data analysis and visualization techniques.</p>
<p>Two things that sets spatial data apart from other data types:
1. In non-spatial data, we care about statistical relationships(How variable X influence variable Y)
In spatial data, we care more about location-based relationships(How points/locations are related in space)
2. Spatial data are often organized in multiple layers, so for example we can have a location with
layers elevation, temperature, vegetation coverage… and they stack together.</p>
<p>Today, we will start by directly download a dataset from Movebank:</p>
<p>In R, by using “move” and “move2”package, we can directly download data sets from MoveBank.
But first, you need a Movebank account to login. So open and past this link into your browser:
<a href="https://www.movebank.org/cms/movebank-main" class="uri">https://www.movebank.org/cms/movebank-main</a>
Use “Login/Register” at top right to login.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="working-with-spatial-data.html#cb36-1" tabindex="-1"></a><span class="co"># Now you can login directly through RStudio:</span></span>
<span id="cb36-2"><a href="working-with-spatial-data.html#cb36-2" tabindex="-1"></a>loginStored <span class="ot">&lt;-</span> <span class="fu">movebankLogin</span>(<span class="at">username=</span><span class="st">&quot;Your_username&quot;</span>, <span class="at">password=</span><span class="st">&quot;Your_password&quot;</span>)</span></code></pre></div>
<p>Next, we need to find a study that we want to explore in R,
For our purpose of the lab, we are using cheetah data for demonstration
To do that, go back to Movebank page, in “Data” section, go to “Explore map”, and on the left you should see a search bar, check the box “Only studies where I can see data” and enter “Cheetah Pilanesberg National Park”
Next, click the box with “i” that’s next to the study name and select “Open in studies page”
Here is all the information you need to load the dataset!</p>
<p>Before moving to R, you need to check the terms and conditions, in Movebank study page, click “Download data”, and agree to the
terms and conditions. Once agreed, you are all set to continue!</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="working-with-spatial-data.html#cb37-1" tabindex="-1"></a><span class="co"># Now in the study page, find the &quot;Movebank ID&quot; and enter it in the code below next to &quot;study = &quot;</span></span>
<span id="cb37-2"><a href="working-with-spatial-data.html#cb37-2" tabindex="-1"></a>cheetah_move <span class="ot">&lt;-</span> <span class="fu">getMovebankData</span>(<span class="at">study =</span> , <span class="at">login =</span> loginStored)</span>
<span id="cb37-3"><a href="working-with-spatial-data.html#cb37-3" tabindex="-1"></a><span class="do">### The study number should be 1260886163</span></span>
<span id="cb37-4"><a href="working-with-spatial-data.html#cb37-4" tabindex="-1"></a></span>
<span id="cb37-5"><a href="working-with-spatial-data.html#cb37-5" tabindex="-1"></a><span class="co">#It&#39;s always a good idea to check the data structure before we began</span></span>
<span id="cb37-6"><a href="working-with-spatial-data.html#cb37-6" tabindex="-1"></a><span class="fu">view</span>(cheetah_dat)</span>
<span id="cb37-7"><a href="working-with-spatial-data.html#cb37-7" tabindex="-1"></a><span class="fu">str</span>(cheetah_move)</span>
<span id="cb37-8"><a href="working-with-spatial-data.html#cb37-8" tabindex="-1"></a><span class="co"># What is the class of the data?</span></span>
<span id="cb37-9"><a href="working-with-spatial-data.html#cb37-9" tabindex="-1"></a></span>
<span id="cb37-10"><a href="working-with-spatial-data.html#cb37-10" tabindex="-1"></a><span class="co"># Let&#39;s transform the data from a MoveStack object into a dataframe</span></span>
<span id="cb37-11"><a href="working-with-spatial-data.html#cb37-11" tabindex="-1"></a>cheetah_dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cheetah_move)</span>
<span id="cb37-12"><a href="working-with-spatial-data.html#cb37-12" tabindex="-1"></a></span>
<span id="cb37-13"><a href="working-with-spatial-data.html#cb37-13" tabindex="-1"></a><span class="fu">head</span>(cheetah_move)</span>
<span id="cb37-14"><a href="working-with-spatial-data.html#cb37-14" tabindex="-1"></a><span class="co"># What kind of information do we have?</span></span>
<span id="cb37-15"><a href="working-with-spatial-data.html#cb37-15" tabindex="-1"></a></span>
<span id="cb37-16"><a href="working-with-spatial-data.html#cb37-16" tabindex="-1"></a><span class="co"># Your turn! Now use select() or dplyr::select() function to create a new data frame called &quot;cheetah_clean&quot; that includes columns of longitude, latitude, tag local identifier, timestamps, and sex.</span></span>
<span id="cb37-17"><a href="working-with-spatial-data.html#cb37-17" tabindex="-1"></a><span class="co"># Remember you can always use view()/head() function to obtain the column names</span></span>
<span id="cb37-18"><a href="working-with-spatial-data.html#cb37-18" tabindex="-1"></a></span>
<span id="cb37-19"><a href="working-with-spatial-data.html#cb37-19" tabindex="-1"></a><span class="do">### it should be something like this:</span></span>
<span id="cb37-20"><a href="working-with-spatial-data.html#cb37-20" tabindex="-1"></a><span class="co"># cheetah_clean &lt;- cheetah_dat %&gt;%</span></span>
<span id="cb37-21"><a href="working-with-spatial-data.html#cb37-21" tabindex="-1"></a><span class="co">#   dplyr::select(</span></span>
<span id="cb37-22"><a href="working-with-spatial-data.html#cb37-22" tabindex="-1"></a><span class="co">#     tag_local_identifier,</span></span>
<span id="cb37-23"><a href="working-with-spatial-data.html#cb37-23" tabindex="-1"></a><span class="co">#     location_lat.1,</span></span>
<span id="cb37-24"><a href="working-with-spatial-data.html#cb37-24" tabindex="-1"></a><span class="co">#     location_long.1,</span></span>
<span id="cb37-25"><a href="working-with-spatial-data.html#cb37-25" tabindex="-1"></a><span class="co">#     timestamps,</span></span>
<span id="cb37-26"><a href="working-with-spatial-data.html#cb37-26" tabindex="-1"></a><span class="co">#     sex)</span></span></code></pre></div>
<div id="understanding-coordinate-reference-systemscrs" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Understanding coordinate reference systems(CRS)<a href="working-with-spatial-data.html#understanding-coordinate-reference-systemscrs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In spatial R, we use different coordinate reference systems(CRS) to define where and how the data is on Earth.
The two most common CRS In R is WGS84 and UTM system, but what is the difference?
Well, WGS84 (World Geodetic System 1984) system are stored as latitude/longitude (lat/lon) in units of degrees, while UTM projects everything on a flat surface in units of meters (x/y) and divided Earth into 60 grids we refereed as UTM Zones.
This difference make WGS84 work well with global datasets/GPS on a larger scale, but it will create distortion near polar regions and on smaller scales.
Remember unlike WGS84, UTM data are stored in meters and uses a grid system, this minimized distortion and make it great for precise local analysis.
Here is a table for better comparison:
| Feature | WGS84 | UTM Zones |
|—————-|—————————|———————————|
| Units | Degrees (°) | Meters (m) |
| Best For | Global | Local analysis |
| Distortion | High near poles | Minimal within zone |
| Data Structure | Lat/Lon | X/Y grid |
Also, be sure to always check your CRS in R with st_crs() or crs()!!! Mixing systems can lead to errors!!</p>
<p>Now going back to our cheetah example, to visualize our data on a map, we need to tell R which CRS we want to use.
To do so, we can use “sf” or “sp” package, both package create spatial layers from vector data.
However,“sf” is relatively new, much newer than “sp”. Which “sp” is the older way of dealing with
spatial vector data in R. That means, some older packages only work with “sp” data, not
“sf” data. This includes home range package(adehabitatHR) we are going to use later today, but ggplot only works with “sf” data! So we need to switch back and forth.</p>
<p>Let’s try it with “sf” package first!</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="working-with-spatial-data.html#cb38-1" tabindex="-1"></a><span class="co"># We can convert our cleaned data to an &quot;sf&quot; object using st_as_sf()</span></span>
<span id="cb38-2"><a href="working-with-spatial-data.html#cb38-2" tabindex="-1"></a><span class="co"># For coordinates, be sure to put longitude first!</span></span>
<span id="cb38-3"><a href="working-with-spatial-data.html#cb38-3" tabindex="-1"></a>cheetah_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(cheetah_clean, </span>
<span id="cb38-4"><a href="working-with-spatial-data.html#cb38-4" tabindex="-1"></a>                     <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;location_long.1&quot;</span>, <span class="st">&quot;location_lat.1&quot;</span>), </span>
<span id="cb38-5"><a href="working-with-spatial-data.html#cb38-5" tabindex="-1"></a>                     <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb38-6"><a href="working-with-spatial-data.html#cb38-6" tabindex="-1"></a><span class="co"># Note the number &quot;4326&quot; is the EPSG code for WGS84, which tells R how to interpret the coordinates.</span></span>
<span id="cb38-7"><a href="working-with-spatial-data.html#cb38-7" tabindex="-1"></a></span>
<span id="cb38-8"><a href="working-with-spatial-data.html#cb38-8" tabindex="-1"></a><span class="co"># Let&#39;s check the class of the new dataframe, it should say &quot;sf&quot; &quot;data.frame&quot;</span></span>
<span id="cb38-9"><a href="working-with-spatial-data.html#cb38-9" tabindex="-1"></a><span class="fu">class</span>(cheetah_sf)</span>
<span id="cb38-10"><a href="working-with-spatial-data.html#cb38-10" tabindex="-1"></a></span>
<span id="cb38-11"><a href="working-with-spatial-data.html#cb38-11" tabindex="-1"></a><span class="co"># Now we can use the sf object we created and visualize with ggplot!</span></span>
<span id="cb38-12"><a href="working-with-spatial-data.html#cb38-12" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb38-13"><a href="working-with-spatial-data.html#cb38-13" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> cheetah_sf, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb38-14"><a href="working-with-spatial-data.html#cb38-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cheetah Locations (WGS84)&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-15"><a href="working-with-spatial-data.html#cb38-15" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb38-16"><a href="working-with-spatial-data.html#cb38-16" tabindex="-1"></a></span>
<span id="cb38-17"><a href="working-with-spatial-data.html#cb38-17" tabindex="-1"></a><span class="co"># sf object also supports fancy interactive maps liken mapview package, try zoom in/out and change map layers!</span></span>
<span id="cb38-18"><a href="working-with-spatial-data.html#cb38-18" tabindex="-1"></a><span class="fu">mapview</span>(cheetah_sf)</span></code></pre></div>
<p>“sp” package and home range</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="working-with-spatial-data.html#cb39-1" tabindex="-1"></a><span class="co"># Let&#39;s first create a copy from our clean data</span></span>
<span id="cb39-2"><a href="working-with-spatial-data.html#cb39-2" tabindex="-1"></a>cheetah_sp <span class="ot">&lt;-</span> cheetah_clean</span></code></pre></div>
<p>For home range estimation (which home range is the area that’s regularly used by animal), requires units in meter, so we will use UTM system for CRS.</p>
<p>Unlike with the package “sf” that we just used, in “sp” package, we need to assign the
coordinates using “coordinates()” and the crs using “proj4string()”.
Unfortunately, “sp” doesn’t work nearly as well with the tidyverse as “sf”, so we have to run the code one at a time instead of writing a pipe.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="working-with-spatial-data.html#cb40-1" tabindex="-1"></a><span class="co"># First, set the coordinates, and Longitude always go before latitude!</span></span>
<span id="cb40-2"><a href="working-with-spatial-data.html#cb40-2" tabindex="-1"></a><span class="fu">coordinates</span>(cheetah_sp) <span class="ot">&lt;-</span> <span class="er">~</span> location_long<span class="fl">.1</span> <span class="sc">+</span> location_lat<span class="fl">.1</span></span>
<span id="cb40-3"><a href="working-with-spatial-data.html#cb40-3" tabindex="-1"></a></span>
<span id="cb40-4"><a href="working-with-spatial-data.html#cb40-4" tabindex="-1"></a></span>
<span id="cb40-5"><a href="working-with-spatial-data.html#cb40-5" tabindex="-1"></a><span class="co"># Remember, for UTMs, we need to specify the zone. From the project summery we know that Pilanesberg National Park is in Zone 35 S (South), and now we can manually assigned the coordinates using proj4string().</span></span>
<span id="cb40-6"><a href="working-with-spatial-data.html#cb40-6" tabindex="-1"></a><span class="fu">proj4string</span>(cheetah_sp) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span>
<span id="cb40-7"><a href="working-with-spatial-data.html#cb40-7" tabindex="-1"></a></span>
<span id="cb40-8"><a href="working-with-spatial-data.html#cb40-8" tabindex="-1"></a><span class="co"># Note this is still in WGS84, so we need to transform to UTM Zone 35S to avoid errors</span></span>
<span id="cb40-9"><a href="working-with-spatial-data.html#cb40-9" tabindex="-1"></a>cheetah_sp_utm <span class="ot">&lt;-</span> <span class="fu">spTransform</span>(cheetah_sp, </span>
<span id="cb40-10"><a href="working-with-spatial-data.html#cb40-10" tabindex="-1"></a>                            <span class="fu">CRS</span>(<span class="st">&quot;+proj=utm +zone=35 +south +datum=WGS84 +units=m +no_defs&quot;</span>))</span>
<span id="cb40-11"><a href="working-with-spatial-data.html#cb40-11" tabindex="-1"></a></span>
<span id="cb40-12"><a href="working-with-spatial-data.html#cb40-12" tabindex="-1"></a><span class="co"># Check the class of the new dataframe</span></span>
<span id="cb40-13"><a href="working-with-spatial-data.html#cb40-13" tabindex="-1"></a><span class="fu">class</span>(cheetah_sp_utm)</span>
<span id="cb40-14"><a href="working-with-spatial-data.html#cb40-14" tabindex="-1"></a><span class="co"># Now the data should be in SpatialPointsDataFrame</span></span></code></pre></div>
<p>Let’s now find the home range for our cheetah using minim!m convex polygon (MCP)!
MCP basically the smallest convex polygon that contains the percentage of area used by animals, it’s a tool that everyone like to use in ecology, and it’s fun to visulize!
(You don’t really have to understand this, but it help picturing the application of spatial R!)</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="working-with-spatial-data.html#cb41-1" tabindex="-1"></a><span class="co"># Here we can use the mcp.area() function to calculate the home range from 0 to 100%</span></span>
<span id="cb41-2"><a href="working-with-spatial-data.html#cb41-2" tabindex="-1"></a>cheetah_mcp_areas_sp <span class="ot">&lt;-</span> <span class="fu">mcp.area</span>(cheetah_sp_utm[<span class="dv">1</span>], <span class="at">unin =</span> <span class="st">&quot;m&quot;</span>, <span class="at">unout =</span> <span class="st">&quot;km2&quot;</span>)</span>
<span id="cb41-3"><a href="working-with-spatial-data.html#cb41-3" tabindex="-1"></a></span>
<span id="cb41-4"><a href="working-with-spatial-data.html#cb41-4" tabindex="-1"></a><span class="co"># Which then we can take a quick look and plot them out</span></span>
<span id="cb41-5"><a href="working-with-spatial-data.html#cb41-5" tabindex="-1"></a><span class="fu">plot</span>(cheetah_mcp_areas_sp)</span></code></pre></div>
<p>Want to visulize the the MCPs with ggplot?
Remember spatial points(sp) cannot be directly plotted using ggplot, so we need to convert them to sf objects before plotting</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="working-with-spatial-data.html#cb42-1" tabindex="-1"></a><span class="co"># We can also visualize the 95% and 50% mcp by calculate the home range individually</span></span>
<span id="cb42-2"><a href="working-with-spatial-data.html#cb42-2" tabindex="-1"></a>cheetah_mcp_95_sp <span class="ot">&lt;-</span> <span class="fu">mcp</span>(cheetah_sp_utm[<span class="dv">1</span>], <span class="at">percent =</span> <span class="dv">95</span>)</span>
<span id="cb42-3"><a href="working-with-spatial-data.html#cb42-3" tabindex="-1"></a>cheetah_mcp_50_sp <span class="ot">&lt;-</span> <span class="fu">mcp</span>(cheetah_sp_utm[<span class="dv">1</span>], <span class="at">percent =</span> <span class="dv">50</span>)</span>
<span id="cb42-4"><a href="working-with-spatial-data.html#cb42-4" tabindex="-1"></a></span>
<span id="cb42-5"><a href="working-with-spatial-data.html#cb42-5" tabindex="-1"></a><span class="co"># Yes you can convert the data to sf objects before plotting, but here we will convert them inside the ggplot to save space</span></span>
<span id="cb42-6"><a href="working-with-spatial-data.html#cb42-6" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb42-7"><a href="working-with-spatial-data.html#cb42-7" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> <span class="fu">st_as_sf</span>(cheetah_mcp_95_sp), <span class="at">fill =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="working-with-spatial-data.html#cb42-8" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> <span class="fu">st_as_sf</span>(cheetah_mcp_50_sp), <span class="at">fill =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-9"><a href="working-with-spatial-data.html#cb42-9" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> <span class="fu">st_as_sf</span>(cheetah_sp_utm), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-10"><a href="working-with-spatial-data.html#cb42-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;95% and 50% MCP Home Ranges for Cheetah CF01&quot;</span>) <span class="sc">+</span></span>
<span id="cb42-11"><a href="working-with-spatial-data.html#cb42-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb42-12"><a href="working-with-spatial-data.html#cb42-12" tabindex="-1"></a></span>
<span id="cb42-13"><a href="working-with-spatial-data.html#cb42-13" tabindex="-1"></a><span class="co"># Also try using the fancy mapview to take a closer look</span></span>
<span id="cb42-14"><a href="working-with-spatial-data.html#cb42-14" tabindex="-1"></a><span class="fu">mapview</span>(<span class="fu">st_as_sf</span>(cheetah_mcp_95_sp), <span class="at">col.regions =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">alpha.regions =</span> <span class="fl">0.5</span>, <span class="at">layer.name =</span> <span class="st">&quot;95% MCP&quot;</span>) <span class="sc">+</span> </span>
<span id="cb42-15"><a href="working-with-spatial-data.html#cb42-15" tabindex="-1"></a>  <span class="fu">mapview</span>(<span class="fu">st_as_sf</span>(cheetah_mcp_50_sp), <span class="at">col.regions =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">alpha.regions =</span> <span class="fl">0.5</span>, <span class="at">layer.name =</span> <span class="st">&quot;50% MCP&quot;</span>) <span class="sc">+</span></span>
<span id="cb42-16"><a href="working-with-spatial-data.html#cb42-16" tabindex="-1"></a>  <span class="fu">mapview</span>(<span class="fu">st_as_sf</span>(cheetah_sp_utm), <span class="at">col.regions =</span> <span class="st">&quot;black&quot;</span>, <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">layer.name =</span> <span class="st">&quot;GPS Locations&quot;</span>)</span></code></pre></div>
<p>Your turn!
Now we are going to work on another data set from a puma project in Utah
Try using the code we already used!</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="working-with-spatial-data.html#cb43-1" tabindex="-1"></a><span class="co"># First, download the puma data from Movebank, I already had the study number for you this time</span></span>
<span id="cb43-2"><a href="working-with-spatial-data.html#cb43-2" tabindex="-1"></a>puma_move <span class="ot">&lt;-</span> <span class="fu">getMovebankData</span>(<span class="at">study =</span> <span class="dv">1720694224</span>, <span class="at">login =</span> loginStored)</span>
<span id="cb43-3"><a href="working-with-spatial-data.html#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="working-with-spatial-data.html#cb43-4" tabindex="-1"></a><span class="co">#1. Now convert the our puma_move object to a dataframe called &quot;puma_dat&quot; using as.data.frame() function</span></span>
<span id="cb43-5"><a href="working-with-spatial-data.html#cb43-5" tabindex="-1"></a></span>
<span id="cb43-6"><a href="working-with-spatial-data.html#cb43-6" tabindex="-1"></a><span class="do">## puma_dat &lt;- as.data.frame(puma_move)</span></span>
<span id="cb43-7"><a href="working-with-spatial-data.html#cb43-7" tabindex="-1"></a></span>
<span id="cb43-8"><a href="working-with-spatial-data.html#cb43-8" tabindex="-1"></a></span>
<span id="cb43-9"><a href="working-with-spatial-data.html#cb43-9" tabindex="-1"></a><span class="co">#2. Use dplyr::select() function to create a new data frame called &quot;puma_clean&quot; that includes columns of longitude, latitude, tag local identifier, timestamps, also use dplyr::filter() to filter out only puma in the taxonomy species.</span></span>
<span id="cb43-10"><a href="working-with-spatial-data.html#cb43-10" tabindex="-1"></a><span class="co"># Hint: you can use view()/head() to see the column names</span></span>
<span id="cb43-11"><a href="working-with-spatial-data.html#cb43-11" tabindex="-1"></a></span>
<span id="cb43-12"><a href="working-with-spatial-data.html#cb43-12" tabindex="-1"></a></span>
<span id="cb43-13"><a href="working-with-spatial-data.html#cb43-13" tabindex="-1"></a><span class="co"># puma_clean &lt;- puma_dat %&gt;%</span></span>
<span id="cb43-14"><a href="working-with-spatial-data.html#cb43-14" tabindex="-1"></a><span class="co">#   dplyr::filter(taxon_canonical_name == &quot;Puma concolor&quot;) %&gt;%</span></span>
<span id="cb43-15"><a href="working-with-spatial-data.html#cb43-15" tabindex="-1"></a><span class="co">#   dplyr::select(</span></span>
<span id="cb43-16"><a href="working-with-spatial-data.html#cb43-16" tabindex="-1"></a><span class="co">#     local_identifier,</span></span>
<span id="cb43-17"><a href="working-with-spatial-data.html#cb43-17" tabindex="-1"></a><span class="co">#     location_lat,</span></span>
<span id="cb43-18"><a href="working-with-spatial-data.html#cb43-18" tabindex="-1"></a><span class="co">#     location_long,</span></span>
<span id="cb43-19"><a href="working-with-spatial-data.html#cb43-19" tabindex="-1"></a><span class="co">#     timestamps)</span></span>
<span id="cb43-20"><a href="working-with-spatial-data.html#cb43-20" tabindex="-1"></a></span>
<span id="cb43-21"><a href="working-with-spatial-data.html#cb43-21" tabindex="-1"></a></span>
<span id="cb43-22"><a href="working-with-spatial-data.html#cb43-22" tabindex="-1"></a><span class="co">#3. Next, use st_as_sf() to convert our cleaned data to sfobject called &quot;puma_sf&quot;, and set crs to 4326</span></span>
<span id="cb43-23"><a href="working-with-spatial-data.html#cb43-23" tabindex="-1"></a><span class="co"># puma_sf &lt;- st_as_sf(puma_clean, </span></span>
<span id="cb43-24"><a href="working-with-spatial-data.html#cb43-24" tabindex="-1"></a><span class="co">#                    coords = c(&quot;location_long&quot;, &quot;location_lat&quot;), </span></span>
<span id="cb43-25"><a href="working-with-spatial-data.html#cb43-25" tabindex="-1"></a><span class="co">#                    crs = 4326)</span></span>
<span id="cb43-26"><a href="working-with-spatial-data.html#cb43-26" tabindex="-1"></a></span>
<span id="cb43-27"><a href="working-with-spatial-data.html#cb43-27" tabindex="-1"></a><span class="co">#4. Now creat a ggplot to visualize the data initially, for sf data, you should use geom_sf(), you can also try mapview() for a better look</span></span>
<span id="cb43-28"><a href="working-with-spatial-data.html#cb43-28" tabindex="-1"></a><span class="co"># ggplot() +</span></span>
<span id="cb43-29"><a href="working-with-spatial-data.html#cb43-29" tabindex="-1"></a><span class="co">#   geom_sf(data = puma_sf) +</span></span>
<span id="cb43-30"><a href="working-with-spatial-data.html#cb43-30" tabindex="-1"></a><span class="co">#   theme_bw()</span></span>
<span id="cb43-31"><a href="working-with-spatial-data.html#cb43-31" tabindex="-1"></a></span>
<span id="cb43-32"><a href="working-with-spatial-data.html#cb43-32" tabindex="-1"></a></span>
<span id="cb43-33"><a href="working-with-spatial-data.html#cb43-33" tabindex="-1"></a><span class="co">#5. Let&#39;s convert to sp object for home range analysis</span></span>
<span id="cb43-34"><a href="working-with-spatial-data.html#cb43-34" tabindex="-1"></a><span class="co"># a) Create a copy of puma_clean called &quot;puma_sp&quot;</span></span>
<span id="cb43-35"><a href="working-with-spatial-data.html#cb43-35" tabindex="-1"></a><span class="co"># b) Use coordinates() to set spatial coordinates</span></span>
<span id="cb43-36"><a href="working-with-spatial-data.html#cb43-36" tabindex="-1"></a><span class="co"># c) Use proj4string() to set WGS84 CRS</span></span>
<span id="cb43-37"><a href="working-with-spatial-data.html#cb43-37" tabindex="-1"></a><span class="co"># puma_sp &lt;- puma_clean</span></span>
<span id="cb43-38"><a href="working-with-spatial-data.html#cb43-38" tabindex="-1"></a><span class="co"># coordinates(puma_sp) &lt;- ~ location_long + location_lat</span></span>
<span id="cb43-39"><a href="working-with-spatial-data.html#cb43-39" tabindex="-1"></a><span class="co"># proj4string(puma_sp) &lt;- CRS(&quot;+proj=longlat +datum=WGS84&quot;)</span></span>
<span id="cb43-40"><a href="working-with-spatial-data.html#cb43-40" tabindex="-1"></a></span>
<span id="cb43-41"><a href="working-with-spatial-data.html#cb43-41" tabindex="-1"></a><span class="co"># Next, we will transform to UTMs and create MCP polygons, since Utah is in UTM Zone 12N, we will use that instead.</span></span>
<span id="cb43-42"><a href="working-with-spatial-data.html#cb43-42" tabindex="-1"></a><span class="co"># Here I had the code for you, so no worries.</span></span>
<span id="cb43-43"><a href="working-with-spatial-data.html#cb43-43" tabindex="-1"></a>puma_sp_utm <span class="ot">&lt;-</span> <span class="fu">spTransform</span>(puma_sp, </span>
<span id="cb43-44"><a href="working-with-spatial-data.html#cb43-44" tabindex="-1"></a>                         <span class="fu">CRS</span>(<span class="st">&quot;+proj=utm +zone=12 +datum=WGS84 +units=m +no_defs&quot;</span>))</span>
<span id="cb43-45"><a href="working-with-spatial-data.html#cb43-45" tabindex="-1"></a>puma_mcp_95_sp <span class="ot">&lt;-</span> <span class="fu">mcp</span>(puma_sp_utm[<span class="dv">1</span>], <span class="at">percent =</span> <span class="dv">95</span>)</span>
<span id="cb43-46"><a href="working-with-spatial-data.html#cb43-46" tabindex="-1"></a>puma_mcp_50_sp <span class="ot">&lt;-</span> <span class="fu">mcp</span>(puma_sp_utm[<span class="dv">1</span>], <span class="at">percent =</span> <span class="dv">50</span>)</span>
<span id="cb43-47"><a href="working-with-spatial-data.html#cb43-47" tabindex="-1"></a></span>
<span id="cb43-48"><a href="working-with-spatial-data.html#cb43-48" tabindex="-1"></a><span class="co">#6. Now, make a ggplot and/or mapview to visulize the MCPs, remember you need to convert the data to sf objects first!</span></span>
<span id="cb43-49"><a href="working-with-spatial-data.html#cb43-49" tabindex="-1"></a><span class="co"># ggplot() +</span></span>
<span id="cb43-50"><a href="working-with-spatial-data.html#cb43-50" tabindex="-1"></a><span class="co">#   geom_sf(data = st_as_sf(puma_mcp_95_sp), fill = &quot;blue&quot;, alpha = 0.5) +</span></span>
<span id="cb43-51"><a href="working-with-spatial-data.html#cb43-51" tabindex="-1"></a><span class="co">#   geom_sf(data = st_as_sf(puma_mcp_50_sp), fill = &quot;lightblue&quot;, alpha = 0.5) +</span></span>
<span id="cb43-52"><a href="working-with-spatial-data.html#cb43-52" tabindex="-1"></a><span class="co">#   geom_sf(data = st_as_sf(puma_sp_utm), color = &quot;red&quot;, size = 0.5, alpha = 0.5) +</span></span>
<span id="cb43-53"><a href="working-with-spatial-data.html#cb43-53" tabindex="-1"></a><span class="co">#   theme_bw()</span></span>
<span id="cb43-54"><a href="working-with-spatial-data.html#cb43-54" tabindex="-1"></a></span>
<span id="cb43-55"><a href="working-with-spatial-data.html#cb43-55" tabindex="-1"></a><span class="co"># mapview(st_as_sf(puma_mcp_95_sp), col.regions = &quot;blue&quot;, layer.name = &quot;95% MCP&quot;) + </span></span>
<span id="cb43-56"><a href="working-with-spatial-data.html#cb43-56" tabindex="-1"></a><span class="co">#   mapview(st_as_sf(puma_mcp_50_sp), col.regions = &quot;lightblue&quot;, layer.name = &quot;50% MCP&quot;) +</span></span>
<span id="cb43-57"><a href="working-with-spatial-data.html#cb43-57" tabindex="-1"></a><span class="co">#   mapview(st_as_sf(puma_sp_utm), col.regions = &quot;red&quot;,layer.name = &quot;GPS Locations&quot;)</span></span></code></pre></div>
<p>Credits for this lab:
1. University of California, Davis, course WFC 155 lab 5 and 8
2. Intro to spatial R by Claudia A Engel: <a href="https://cengel.github.io/R-spatial/intro.html" class="uri">https://cengel.github.io/R-spatial/intro.html</a></p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="modeling-conditionals-loops-functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lab-1-r-data-and-the-rstudio-panels-2025.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/refurrow/wfc70/edit/main/10-spatial_data.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/refurrow/wfc70/blob/main/10-spatial_data.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
